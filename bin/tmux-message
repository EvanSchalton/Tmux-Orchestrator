#!/bin/bash

# Send message to Claude agent in tmux window
# Usage: send-claude-message.sh <session:window> <message>

if [ $# -lt 2 ]; then
    echo "Usage: $0 <session:window> <message>"
    echo "Example: $0 agentic-seek:3 'Hello Claude!'"
    exit 1
fi

WINDOW="$1"
shift  # Remove first argument, rest is the message
MESSAGE="$*"

# Clear any existing input first and ensure clean state
tmux send-keys -t "$WINDOW" C-c
sleep 0.5

# Clear the input line completely
tmux send-keys -t "$WINDOW" C-u
sleep 0.5

# Send the message
tmux send-keys -t "$WINDOW" "$MESSAGE"

# Wait for Claude to fully render the message
sleep 3.0

# Move cursor to end of line (in case it's not there)
tmux send-keys -t "$WINDOW" End
sleep 0.2

# Send Enter to submit - multiple times with delays
tmux send-keys -t "$WINDOW" Enter
sleep 1.0
tmux send-keys -t "$WINDOW" Enter
sleep 0.5
tmux send-keys -t "$WINDOW" Enter
sleep 0.5

# One more Enter after a pause, just to be sure
sleep 1.0
tmux send-keys -t "$WINDOW" Enter

echo "Message sent to $WINDOW: $MESSAGE"
